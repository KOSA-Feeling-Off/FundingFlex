<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper
	namespace="com.fundingflex.mybatis.mapper.member.MembersMapper">
<!-- signup  -->
	<insert id="insertMember">
		INSERT INTO members (email, nickname, password, profile_url, created_at, created_by, updated_at, updated_by, role)
		VALUES (#{email}, #{nickname}, #{password}, #{profileUrl, jdbcType=VARCHAR}, #{createdAt}, #{createdBy}, #{updatedAt, jdbcType=TIMESTAMP}, #{updatedBy, jdbcType=VARCHAR}, #{role})
	</insert>

	<select id="selectByEmail"
		resultType="com.fundingflex.member.domain.entity.Members">
		SELECT * FROM members WHERE email = #{email}
	</select>

	<select id="existsByEmail" resultType="boolean">
		SELECT CASE WHEN COUNT(*)
		> 0 THEN 1 ELSE 0 END AS result
		FROM members WHERE email = #{email}
	</select>

	<select id="findByEmail"
		resultType="com.fundingflex.member.domain.entity.Members">
		SELECT * FROM members WHERE email = #{email}
	</select>

	<select id="existsByNickname" resultType="boolean">
		SELECT CASE WHEN
		COUNT(*) > 0 THEN 1 ELSE 0 END AS result
		FROM members WHERE nickname = #{nickname}
	</select>
	
	<select id="findMemberInfoById" resultType="com.fundingflex.member.domain.entity.Members">
        SELECT 
            user_id AS userId,
            email,
            nickname,
            password,
            profile_url AS profileUrl,
            created_at AS createdAt,
            created_by AS createdBy,
            updated_at AS updatedAt,
            updated_by AS updatedBy,
            role
        FROM members
        WHERE user_id = #{userId}
    </select>
</mapper>